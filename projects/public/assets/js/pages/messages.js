(()=>{"use strict";const e=e=>document.getElementById(`${e}`),t=t=>{s(t.id);const n=e("messages");let a="success",o="start",r="Saya";"dokter"===n.dataset.role?t.is_dokter||(a="primary",o="end",r=t.user.name):1===t.is_dokter&&(a="primary",o="end",r="Dokter");const i=new Date(1e3*t.times);let l=i.getHours();l<10&&(l="0"+l);let m=i.getMinutes();m<10&&(m="0"+m);const d=`${l}.${m}`;n.innerHTML+=`\n        <li class="list-group-item \n            list-group-item-${a} d-flex flex-column align-items-${o}">\n            <span class="text-secondary" style="font-size: 12px">\n                ${r} | ${d}\n            </span>\n            ${t.message}\n        </li>\n        `};e("send-message").addEventListener("click",(s=>{s.preventDefault();const{target:n}=s,{form:a}=n;fetch(`${origin}/messages`,{method:"POST",body:new FormData(a)}).then((e=>e.json())).then((s=>{t(s),e("messageTA").value=""}))}));const s=e=>sessionStorage.setItem("lastMessage",e);setInterval((()=>{const e=sessionStorage.getItem("lastMessage");e&&fetch(`${origin}/new/messages/${e}`).then((e=>e.json())).then((e=>{e.length>0&&e.map((e=>t(e)))}))}),2e3),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("[data-last-message]").dataset.lastMessage;s(e)}))})();