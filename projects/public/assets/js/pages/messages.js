(()=>{"use strict";const e=e=>document.getElementById(`${e}`),s=s=>{t(s.id);const n=e("messages"),a=parseInt(n.dataset.userId)===parseInt(s.user_id),o=new Date(1e3*s.times);let r=o.getHours();r<10&&(r="0"+r);let i=o.getMinutes();i<10&&(i="0"+i);const l=`${r}.${i}`;let m=a?"Saya":s.user.name;1===parseInt(s.is_dokter)&&(m=a?"Saya":`Dokter :  ${s.user.name}`),n.innerHTML+=`\n        <li class="list-group-item \n        list-group-item-${a?"success":"primary"}\n        d-flex flex-column\n        align-items-${a?"start":"end"}">\n            <span class="text-secondary" style="font-size: 12px">\n                ${m} | ${l}\n            </span>\n\n            ${s.message}\n        </li >\n        `};e("send-message").addEventListener("click",(e=>{e.preventDefault();const{target:t}=e,{form:n}=t;fetch(`${origin}/messages`,{method:"POST",body:new FormData(n)}).then((e=>e.json())).then((e=>s(e)))}));const t=e=>{const s=e??document.querySelector("[data-last-message]").dataset.lastMessage;sessionStorage.setItem("lastMessage",s)};setInterval((()=>{const e=sessionStorage.getItem("lastMessage");fetch(`${origin}/new/messages/${e}`).then((e=>e.json())).then((e=>{e.length>0&&e.map((e=>s(e)))}))}),2e3),document.addEventListener("DOMContentLoaded",(()=>t()))})();